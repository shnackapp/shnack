<%= render 'top_nav' %>

<h2 class="SSS">My Restaurant</h2>
<div class="row-new well">
	<h4 class="SSS pad-bot">Current Revenue Status</h4>
	<div class="column-mobile six clear-fix">
		<strong> Amount Available: </strong> <%= Order.integer_to_currency @amount %>
		<br />
		<% if @amount == 0 %>
			<%= button_to "Nothing to Withdraw", '/#', { :class => "disabled mar-y", disabled: "disabled" } %>
		<% else %>
			<%= button_to "Withdraw", withdraw_funds_restaurant_path(@restaurant), { :class => "blue mar-y", :method => 'post' } %>
		<% end %>

<h2 class="headline"> <%= @restaurant.name %> </h2>

	<div class="well">
		<div>
			<strong> Amount Available: </strong> <%= Order.integer_to_currency @amount %><br />
			<div style="padding-top:10px;">
			<%= button_to "Recent Orders", recent_orders_restaurant_path(@restaurant), {:method => 'get', :class => "btn btn-info" } %> </div>
		</div>

	</div>


<div class ="panel panel-default">
	<% @restaurant.menu.categories.each do |category| %>
	<div class="panel-heading top-heading"><h3 class="panel-title"><%= category.name %></h3></div>
	<div style="display:none;">
	<table class="table">
		<% category.items.each do |item| %>
			<tbody>
				<tr class="item-name">
					<td ><%= link_to item.name, {:action => "edit_item", :controller => "menu", :item_id => item.id} %></td>
					<td class="text-right"><%= Item.integer_to_currency item.price %></td>
					<td class="text-right" style="width:5%"><%= link_to content_tag(:span, nil, :class=> "glyphicon glyphicon-minus"), { :controller => 'menu', :action => 'delete_item', :item_id => item.id } %></td>
				</tr>
				<% if item.has_description? %>
					<tr>
						<td colspan="3" class="item-description"><%= item.description %></td>
					</tr>
				<% end %>
			</tbody>

			<% if item.modifiers.size > 0 %>
				<tbody style="background-color:#F9F9F9;">
					<% item.modifiers.each do |mod| %>
						<%  unless mod.name.empty? %>
							<tr class="item-modifier">
								<td class="modifier-name" colspan="3">
									<em> <%= mod.name.capitalize %> </em>
								</td>
									
									<% mod.options.each do |val| %>
										<%  unless val.name.empty? %>
											<tr>
												<td colspan="2"> <%= val.name.capitalize %> </td>
												<td><%= Order.integer_to_currency val.price %></td>
											</tr>
										<% end %>
									<% end %>
								</tr>
							<% end %>
					<% end %>
				</tbody>
			<% end %>
		<% end %>
	</table>
	</div>
	<% end %>
</div>


<% if current_user.is_super? %>
	<section class="wrapper pad-y-xlrg">
		<h4 class="SSS">Managers</h4>

		<% @restaurant.roles.each do |role| %>
			<div> <%= role.user.email %> </div>
		<% end %>

		<%= form_tag add_manager_restaurant_path(@restaurant)  do %>
			<label>Add Manager By Email</label>
			<ol>
				<%= text_field_tag :email, nil, class: '' %>
				<%= submit_tag 'Send Invite', :class => "green" %>
			</ol>
		<% end %>
	</section>
<% end %>


<section class="my-well-lemon">
	<h4 class="SSS">Registration Code:</h4>
	<%= @restaurant.registration_code %> <%= link_to "Generate new code", new_registration_code_restaurant_path(@restaurant) %>
	<br /><br />
	<h4 class="SSS">Add Tax? <span class="tax">- <%= @restaurant.add_tax %></span></h4>
	<h4 class="SSS">Tax: <span class="tax"><%= @restaurant.tax %></span></h4>
	<br />

	<%= link_to "Edit Restaurant", edit_restaurant_path(@restaurant), class: "action-btn" %>
	<%= link_to "Delete Restaurant", restaurant_path(@restaurant), :method => :delete, class: "action-btn red right" %>
</section>
